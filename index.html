<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>Brawl Style Craft</title>
<script src="https://telegram.org/js/telegram-web-app.js"></script>

<style>
html,body{
  margin:0;
  padding:0;
  width:100%;
  height:100%;
  background:#000;
  overflow:hidden;
  font-family:system-ui;
}
#app{width:100%;height:100%}

/* ===== СИНИЙ ФОН ===== */
.blue{
  position:fixed;
  inset:0;
  background:radial-gradient(circle,#2f7bff,#001a55);
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  opacity:0;
  pointer-events:none;
  transition:.4s;
}
.blue.active{
  opacity:1;
  pointer-events:auto;
}

/* ===== ВСПЫШКА ===== */
.flash{
  position:fixed;
  inset:0;
  background:white;
  opacity:0;
  z-index:100;
}

/* ===== ЛУЧИ ===== */
.rays{
  position:absolute;
  width:400px;
  height:400px;
  background:
    repeating-conic-gradient(
      from 0deg,
      rgba(255,255,255,.35) 0deg 10deg,
      transparent 10deg 20deg
    );
  border-radius:50%;
  opacity:0;
  animation:spin 1.2s linear infinite;
}
@keyframes spin{
  to{transform:rotate(360deg)}
}

/* ===== КУБ ===== */
.cube-wrap{
  width:110px;
  height:110px;
  perspective:700px;
  position:relative;
}
.cube{
  width:100%;
  height:100%;
  position:relative;
  transform-style:preserve-3d;
  transition:.15s;
}
.cube.shake{
  animation:shake .12s infinite;
}
@keyframes shake{
  0%{transform:rotateX(-15deg) rotateY(20deg) translate(0,0)}
  25%{transform:rotateX(-15deg) rotateY(20deg) translate(3px,-3px)}
  50%{transform:rotateX(-15deg) rotateY(20deg) translate(-3px,3px)}
  75%{transform:rotateX(-15deg) rotateY(20deg) translate(3px,3px)}
}

.face{
  position:absolute;
  width:110px;
  height:110px;
  background:#1d7cff;
  border-radius:18px;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:48px;
  color:white;
  border:3px solid white;
  box-shadow:0 0 25px rgba(255,255,255,.6);
}
.f{transform:translateZ(55px)}
.b{transform:rotateY(180deg) translateZ(55px)}
.r{transform:rotateY(90deg) translateZ(55px)}
.l{transform:rotateY(-90deg) translateZ(55px)}
.t{transform:rotateX(90deg) translateZ(55px)}
.d{transform:rotateX(-90deg) translateZ(55px)}

/* ===== ПРЕДМЕТ ===== */
.single{
  width:120px;
  height:120px;
  display:none;
  animation:pop .35s ease;
}
@keyframes pop{
  from{transform:scale(.3);opacity:0}
  to{transform:scale(1);opacity:1}
}
.single video{
  width:100%;
  height:100%;
  object-fit:cover;
}

/* ===== РЯД ===== */
.row{
  display:flex;
  gap:14px;
  margin-top:30px;
  opacity:0;
}
.row.active{opacity:1}
.row video{
  width:64px;
  height:64px;
}

/* ===== СЧЁТЧИК ===== */
.counter{
  position:absolute;
  bottom:20px;
  right:20px;
  background:#ff0033;
  padding:10px 20px;
  border-radius:40px;
  font-size:22px;
  font-weight:bold;
  color:white;
}
</style>
</head>

<body>
<div id="app">

<div class="blue" id="blue">

  <div class="rays" id="rays"></div>

  <div class="cube-wrap" id="cubeWrap">
    <div class="cube" id="cube">
      <div class="face f">?</div>
      <div class="face b">?</div>
      <div class="face r">?</div>
      <div class="face l">?</div>
      <div class="face t">?</div>
      <div class="face d">?</div>
    </div>
  </div>

  <div class="single" id="single"></div>
  <div class="row" id="row"></div>
  <div class="counter" id="counter">4</div>

</div>

<div class="flash" id="flash"></div>

</div>

<script>
Telegram.WebApp.ready();
Telegram.WebApp.expand();

/* ===== ДАННЫЕ ===== */
const gifts=[
 {file:"Astral%20Shard.mp4"},
 {file:"Kissed%20Frog.mp4"},
 {file:"Durov-Cap.mp4"},
 {file:"Artisan%20Brick.mp4"}
];

let step=0;
let index=0;

setTimeout(()=>blue.classList.add("active"),800);

/* ===== КЛИК ===== */
blue.onclick=()=>{

  /* 1 — начало тряски */
  if(step===0){
    cube.classList.add("shake");
    rays.style.opacity=.4;
    step=1;
    return;
  }

  /* 2 — усиление */
  if(step===1){
    cube.style.transform="scale(1.08)";
    rays.style.opacity=.7;
    step=2;
    return;
  }

  /* 3 — ВЗРЫВ */
  if(step===2){
    explode();
    step=3;
    return;
  }

  /* ПОКАЗ СЛЕДУЮЩЕГО */
  if(step===3){
    index++;
    counter.textContent=4-index;
    if(index<gifts.length){
      showGift();
    }else{
      showRow();
      step=4;
    }
    return;
  }

  /* ВЫХОД */
  if(step===4){
    location.reload();
  }
};

/* ===== ЭФФЕКТ ВЗРЫВА ===== */
function explode(){
  cube.classList.remove("shake");
  cubeWrap.style.display="none";
  rays.style.opacity=1;
  flash.style.opacity=1;
  setTimeout(()=>flash.style.opacity=0,120);
  showGift();
}

/* ===== ПОКАЗ ===== */
function showGift(){
  single.innerHTML="";
  const v=document.createElement("video");
  v.src="videos/"+gifts[index].file;
  v.autoplay=true;
  v.loop=true;
  v.muted=true;
  v.playsInline=true;
  single.appendChild(v);
  single.style.display="block";
}

function showRow(){
  single.style.display="none";
  gifts.forEach(g=>{
    const v=document.createElement("video");
    v.src="videos/"+g.file;
    v.autoplay=true;
    v.loop=true;
    v.muted=true;
    row.appendChild(v);
  });
  row.classList.add("active");
}
</script>
</body>
</html>